<div class="admin-container">
  <!-- Navbar -->
  <nav class="navbar-clinica">
  <div class="logo">
    <img src="assets/images/icono.ico" alt="Clínica" />
    <div class="titulo-logo">
      <h2>Clínica OnLine</h2>
      <span>Especialistas en Salud</span>
    </div>
  </div>
<ul class="navbar-links">
      <li><button (click)="goTo('solicitar-turno')">Solicitar Turno</button></li>
      <li><button (click)="goTo('registro')">Registrar usuario</button></li>
       <li><button (click)="goTo('turnos')">Turnos</button></li>
      <li><button (click)="toggleCreateAdminForm()">Crear Administrador</button></li>
  <li><button class="logout-btn" (click)="logout()">Cerrar sesión</button></li>
</ul>
</nav>

  <h2>Administrar Usuarios</h2>

  <!-- Mostrar mensaje de error si existe -->
  <div *ngIf="errorMessage" class="error-message">
    <p>{{ errorMessage }}</p>
  </div>

  <!-- Tabla de usuarios -->
  <div class="user-table-container" *ngIf="modo === 'tabla' && users.length">
    <table class="user-table">
      <thead>
        <tr>
          <th>Foto</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Edad</th>
          <th>DNI</th>
          <th>Mail</th>
          <th>Rol</th>
          <th>Obra Social</th>
          <th>Especialidad</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>
            <img *ngIf="user.fotoPerfil" [src]="user.fotoPerfil" alt="Foto de perfil" class="user-img" />
          </td>
          <td>{{ user.nombre }}</td>
          <td>{{ user.apellido }}</td>
          <td>{{ user.edad }}</td>
          <td>{{ user.dni }}</td>
          <td>{{ user.mail }}</td>
          <td>{{ user.rol }}</td>
          <td>{{ user.obraSocial }}</td>
          <td>
          <ng-container *ngIf="isArray(user.especialidades); else textoPlano">
              {{ user.especialidades.join(', ') }}
            </ng-container>
            <ng-template #textoPlano>
              {{ user.especialidades }}
            </ng-template>
          </td>
          <td>{{ user.estado }}</td>
<td>
  <ng-container *ngIf="user.rol?.toLowerCase() === 'especialista'">
    <button *ngIf="user.estado === 'inhabilitado'" (click)="toggleUserStatus(user.id, true)">
      Habilitar
    </button>
    <button *ngIf="user.estado === 'activo'" (click)="toggleUserStatus(user.id, false)">
      Inhabilitar
    </button>
  </ng-container>
</td>

         
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Formulario para crear administrador -->
  <div *ngIf="modo === 'crear-admin'" class="create-admin-container">
    <h3>Crear Administrador</h3>
    <form [formGroup]="formAdmin" (ngSubmit)="createUser(formAdmin.value)">
      <label for="nombre">Nombre</label>
      <input id="nombre" formControlName="nombre" required />

      <label for="apellido">Apellido</label>
      <input id="apellido" formControlName="apellido" required />

      <label for="edad">Edad</label>
      <input id="edad" formControlName="edad" required />

      <label for="dni">DNI</label>
      <input id="dni" formControlName="dni" required />

      <label for="mail">Email</label>
      <input id="mail" formControlName="mail" required />

      <label for="password">Contraseña</label>
      <input id="password" formControlName="password" required type="password" />

      <label for="fotoPerfil">Foto de Perfil</label>
        <input
        id="fotoPerfil"
        type="file"
        (change)="onFileSelected($event)"
        required
        accept="image/*"
      />

      <button type="submit">Crear Administrador</button>
      <button type="button" (click)="volverATabla()">← Volver</button>

    </form>
  </div>
</div>
